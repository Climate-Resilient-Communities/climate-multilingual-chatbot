2025-08-16 17:36:16,107 - datasets - INFO - PyTorch version 2.6.0 available.
INFO:     Started server process [56550]
INFO:     Waiting for application startup.
2025-08-16 17:36:18,829 - src.webui.api.main - INFO - 🚀 Starting Climate Chatbot API...
2025-08-16 17:36:18,829 - src.webui.api.main - INFO - Initializing pipeline components...
2025-08-16 17:36:19,002 - src.models.nova_flow - INFO - ✓ Bedrock client initialized
2025-08-16 17:36:19,071 - src.models.cohere_flow - INFO - ✓ Cohere client initialized
2025-08-16 17:36:19,071 - src.models.gen_response_unified - INFO - ✓ Unified Response Generator initialized
2025-08-16 17:36:19,072 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:36:19,179 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:36:19,180 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:36:19,265 - src.models.nova_flow - INFO - ✓ Bedrock client initialized
2025-08-16 17:36:19,291 - src.models.cohere_flow - INFO - ✓ Cohere client initialized
Fetching 30 files:   0%|          | 0/30 [00:00<?, ?it/s]Fetching 30 files: 100%|██████████| 30/30 [00:00<00:00, 8831.35it/s]
2025-08-16 17:36:20,891 - FlagEmbedding.finetune.embedder.encoder_only.m3.runner - INFO - loading existing colbert_linear and sparse_linear---------
2025-08-16 17:36:20,895 - src.models.climate_pipeline - INFO - ✓ Embedding model initialized with fast tokenizer
2025-08-16 17:36:20,895 - src.models.climate_pipeline - INFO - Init: embeddings model ready in 1.60s
2025-08-16 17:36:20,897 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/luis_ticas/Documents/GitHub/climate-multilingual-chatbot/.venv/lib/python3.12/site-packages/pinecone_plugins'])
2025-08-16 17:36:20,898 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.assistant
2025-08-16 17:36:20,939 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2025-08-16 17:36:20,952 - pinecone_plugin_interface.logging - INFO - Installing plugin assistant into Pinecone
2025-08-16 17:36:20,952 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2025-08-16 17:36:20,952 - src.models.climate_pipeline - INFO - Pinecone: initialized using v5 client
2025-08-16 17:36:21,445 - src.models.climate_pipeline - INFO - Init: pinecone index ready in 0.55s
2025-08-16 17:36:21,684 - src.models.climate_pipeline - INFO - Init: cohere client ready in 0.24s
2025-08-16 17:36:21,684 - src.models.climate_pipeline - INFO - ✓ Climate Query Pipeline initialized (eager heavy-init)
2025-08-16 17:36:21,684 - src.webui.api.main - INFO - ✅ Climate pipeline initialized (prewarming in background)
2025-08-16 17:36:21,684 - src.webui.api.main - INFO - ✅ Conversation parser initialized
2025-08-16 17:36:21,684 - src.webui.api.main - INFO - ✅ Language router initialized
2025-08-16 17:36:21,684 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:36:21,687 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:36:21,687 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:36:21,687 - src.webui.api.main - INFO - ✅ Redis cache initialized
2025-08-16 17:36:21,687 - src.webui.api.main - INFO - 🎉 All components initialized successfully!
2025-08-16 17:36:21,691 - src.webui.api.main - INFO - 🔥 Starting background pipeline prewarming...
2025-08-16 17:36:21,691 - src.models.climate_pipeline - INFO - Prewarm: starting heavy component initialization
2025-08-16 17:36:21,691 - src.models.climate_pipeline - INFO - Prewarm: embeddings ready in 0.00s
2025-08-16 17:36:21,691 - src.models.climate_pipeline - INFO - Prewarming embed model...
You're using a XLMRobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
2025-08-16 17:36:27,772 - src.models.climate_pipeline - INFO - Prewarm encode took 6082ms
2025-08-16 17:36:27,963 - src.models.climate_pipeline - INFO - Second prewarm took 190ms
2025-08-16 17:36:27,963 - src.models.climate_pipeline - INFO - Prewarm: pinecone ready in 0.00s
2025-08-16 17:36:27,963 - src.models.climate_pipeline - INFO - Prewarm: cohere client ready in 0.00s
2025-08-16 17:36:27,963 - src.models.climate_pipeline - INFO - Prewarm complete in 6.27s
2025-08-16 17:36:27,963 - src.webui.api.main - INFO - ✅ Background prewarming completed
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-08-16 17:36:48,942 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380208924 query_len=23 lang=en
2025-08-16 17:36:48,943 - src.webui.api.routers.chat - INFO - Language routing: detected=en model=nova
2025-08-16 17:36:49,363 - src.models.climate_pipeline - INFO - ✓ Language map loaded from languages.json: 187 names → 183 codes (e.g., belarusian→be)
2025-08-16 17:36:49,363 - src.models.climate_pipeline - INFO - Processing query: 'What is climate change?...' in english (code: en)
2025-08-16 17:36:49,363 - src.models.climate_pipeline - INFO - Raw query repr: 'What is climate change?'
2025-08-16 17:36:49,364 - src.models.climate_pipeline - INFO - Router IN → language_name=english, language_code=en
2025-08-16 17:36:49,364 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:36:49,364 - src.models.query_routing - INFO - Language: english (en) → Model: Nova
2025-08-16 17:36:49,367 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=False
2025-08-16 17:36:49,367 - src.models.climate_pipeline - INFO - Router OUT → english_query='What is climate change?'
2025-08-16 17:36:49,367 - src.models.climate_pipeline - INFO - Router OUT → processed_query='What is climate change?'
2025-08-16 17:36:49,367 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:36:49,367 - src.models.climate_pipeline - INFO - Timing: routing=2.7ms
2025-08-16 17:36:49,367 - src.models.climate_pipeline - INFO - Net debug → original_query len=23, utf8_bytes=23
2025-08-16 17:36:49,367 - src.models.climate_pipeline - INFO - Net debug → english_query len=23, utf8_bytes=23
2025-08-16 17:36:49,367 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:36:49,368 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:36:49,403 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:36:49,405 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:36:49,467 - src.models.climate_pipeline - INFO - ✓ Cache hit for english - returning cached response
2025-08-16 17:36:49,469 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380208924 time=0.527s model=nova faithfulness=0.950
2025-08-16 17:36:49,471 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=0.547s id=req_1755380208924 ip=127.0.0.1
INFO:     127.0.0.1:55852 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:36:50,731 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380210723 query_len=28 lang=es
2025-08-16 17:36:50,731 - src.webui.api.routers.chat - INFO - Language routing: detected=es model=nova
2025-08-16 17:36:50,732 - src.models.climate_pipeline - INFO - Processing query: '¿Qué es el cambio climático?...' in spanish (code: es)
2025-08-16 17:36:50,738 - src.models.climate_pipeline - INFO - Raw query repr: '¿Qué es el cambio climático?'
2025-08-16 17:36:50,738 - src.models.climate_pipeline - INFO - Router IN → language_name=spanish, language_code=es
2025-08-16 17:36:50,738 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:36:50,738 - src.models.query_routing - INFO - Language: spanish (es) → Model: Nova
2025-08-16 17:36:50,738 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:36:50,738 - src.models.climate_pipeline - INFO - Router OUT → english_query='¿Qué es el cambio climático?'
2025-08-16 17:36:50,738 - src.models.climate_pipeline - INFO - Router OUT → processed_query='¿Qué es el cambio climático?'
2025-08-16 17:36:50,738 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:36:50,738 - src.models.climate_pipeline - INFO - Timing: routing=0.4ms
2025-08-16 17:36:50,739 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:36:50,739 - src.models.query_routing - INFO - Language: spanish (es) → Model: Nova
2025-08-16 17:36:50,739 - src.models.query_routing - INFO - Translating query from spanish to English
2025-08-16 17:36:50,739 - src.models.query_routing - INFO - Router NET IN → query repr='¿Qué es el cambio climático?'
2025-08-16 17:36:52,007 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1268 status=OK request_id=5bf8e929-3ab8-41ed-9eb4-45f25ca5e8b9
2025-08-16 17:36:52,008 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:36:52,008 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What is climate change?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. While climate variability is a natural phenomenon, the term "climate change'
2025-08-16 17:36:52,008 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate variability is a natural phenomenon, the term "climate change'
2025-08-16 17:36:52,008 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate variability is a natural phenomenon, the term "climate change'
2025-08-16 17:36:52,008 - src.models.climate_pipeline - INFO - Net debug → original_query len=28, utf8_bytes=31
2025-08-16 17:36:52,008 - src.models.climate_pipeline - INFO - Net debug → english_query len=561, utf8_bytes=567
2025-08-16 17:36:52,008 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:36:52,010 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:36:52,013 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:36:52,013 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:36:52,014 - src.models.climate_pipeline - INFO - Cache miss for spanish query
2025-08-16 17:36:52,022 - src.models.climate_pipeline - INFO - Timing: cache=13.7ms
2025-08-16 17:36:52,022 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:36:52,022 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:36:52,022 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=es, history_len=0
2025-08-16 17:36:52,022 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='¿Qué es el cambio climático?'
2025-08-16 17:36:52,022 - query_rewriter - INFO - Rewriter NET IN → expected_lang=es, user_query repr='¿Qué es el cambio climático?', norm='¿Qué es el cambio climático?'
2025-08-16 17:36:52,620 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=597 status=OK request_id=8136ecaf-fd5c-4513-a7e0-52f8460edfe9
2025-08-16 17:36:52,671 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Spanish and asks about climate change.","language":"es","expected_language":"es","language_match":true,"classification":"on-topic","rewrite_en":"What is climate change?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:36:52,725 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:36:52,746 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='¿Qué es el cambio climático?...' expected_lang=es detected_lang=es classification=on-topic language_match=True reason='User query is in Spanish and asks about climate change....'
2025-08-16 17:36:52,746 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='es', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:36:52,748 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What is climate change?'
2025-08-16 17:36:52,748 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:36:52,755 - src.models.climate_pipeline - INFO - Timing: rewrite=733.6ms
2025-08-16 17:36:52,755 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:36:52,757 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:36:52,757 - src.models.climate_pipeline - INFO - Timing: guards=1.3ms
2025-08-16 17:36:52,766 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:36:52,784 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:36:52,784 - src.models.retrieval - INFO - Query embedding IN: query_len=23 chars, query_repr='What is climate change?...'
2025-08-16 17:36:54,428 - src.models.retrieval - INFO - dep=query_embed op=encode ms=1643 dense_dim=1024 sparse_tokens=5
2025-08-16 17:36:54,919 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=489 status=OK
2025-08-16 17:36:54,919 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=489 total_ms=489
2025-08-16 17:36:55,145 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=225 status=OK
2025-08-16 17:36:55,145 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:36:55,145 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=225 total_ms=225
2025-08-16 17:36:55,150 - src.models.retrieval - INFO - dep=mmr_embed used_index=9 used_cache=0 embedded=0 ms=0 n_docs=9 valid_vecs=9 q_embed_ms=0
2025-08-16 17:36:55,153 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=11944 n_docs=9
2025-08-16 17:36:55,518 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:36:55,524 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=370.3 status=OK
2025-08-16 17:36:55,532 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.280184954, 'rerank_score': 0.9995272, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.26793474, 'rerank_score': 0.9994536, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.271402389, 'rerank_score': 0.9993857, 'has_values': True}, {'title': "Report For Action Toronto's Climate Change Readiness Updates Oncommitments And A", 'pinecone_score': 0.274087071, 'rerank_score': 0.9984452, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.270209789, 'rerank_score': 0.9980276, 'has_values': True}]
2025-08-16 17:36:55,532 - src.models.retrieval - INFO - q='What is climate change?', base=9, kept_pre=9, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.95, delta=0.100, max_sim_pre=0.280, p50_sim_pre=0.270, p95_sim_pre=0.280, blocked_base=0, dropped_top2=[]
2025-08-16 17:36:55,533 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:36:55,533 - src.models.climate_pipeline - INFO - Timing: retrieval=2748.5ms
2025-08-16 17:36:55,533 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:36:55,533 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:36:55,533 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:36:55,535 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:36:55,535 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:36:55,536 - src.models.gen_response_unified - INFO - Successfully processed 5 documents
2025-08-16 17:36:55,536 - src.models.gen_response_unified - INFO - Successfully processed 5 documents for nova
2025-08-16 17:36:59,158 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=3621 status=OK request_id=02c060f1-fa66-4a10-8cd7-96f0617e96d5
2025-08-16 17:36:59,253 - src.models.gen_response_unified - INFO - nova response cached successfully
2025-08-16 17:36:59,253 - src.models.gen_response_unified - INFO - nova response generation complete
2025-08-16 17:36:59,254 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:36:59,254 - src.models.climate_pipeline - INFO - Timing: generation=3720.9ms
2025-08-16 17:36:59,254 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:37:01,192 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1936 status=OK request_id=7b567093-18b1-4a8a-a5c7-2d727d93bda5
2025-08-16 17:37:01,193 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:37:01,194 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:37:01,194 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:37:01,194 - src.models.climate_pipeline - INFO - Timing: faithfulness=1940.1ms
2025-08-16 17:37:01,194 - src.models.climate_pipeline - INFO - Step 8: Translating response to spanish (code=es)
2025-08-16 17:37:05,471 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=4276 status=OK request_id=42aeb712-09e3-4ace-adc9-fad101c7ee27
2025-08-16 17:37:05,473 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to spanish
2025-08-16 17:37:05,473 - src.models.climate_pipeline - INFO - Timing: translation=4278.7ms
2025-08-16 17:37:05,473 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:05,475 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:05,475 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:05,478 - src.models.climate_pipeline - INFO - ✓ Response cached in spanish
2025-08-16 17:37:05,483 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:37:05,492 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.4 rewrite=733.6 guards=1.3 retrieval=2748.5 generation=3720.9 faithfulness=1940.1 translation=4278.7 total=14740.3
2025-08-16 17:37:05,492 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 14.74s
2025-08-16 17:37:05,493 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380210723 time=14.762s model=nova faithfulness=0.950
2025-08-16 17:37:05,495 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=14.771s id=req_1755380210723 ip=127.0.0.1
INFO:     127.0.0.1:55875 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:37:06,719 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380226717 query_len=11 lang=ja
2025-08-16 17:37:06,719 - src.webui.api.routers.chat - INFO - Language routing: detected=ja model=nova
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Processing query: '気候変動とは何ですか？...' in japanese (code: ja)
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Raw query repr: '気候変動とは何ですか？'
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Router IN → language_name=japanese, language_code=ja
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:37:06,720 - src.models.query_routing - INFO - Language: japanese (ja) → Model: Nova
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Router OUT → english_query='気候変動とは何ですか？'
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Router OUT → processed_query='気候変動とは何ですか？'
2025-08-16 17:37:06,720 - src.models.climate_pipeline - WARNING - Router language mismatch: query is in Chinese but Japanese was selected
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Proceeding despite router mismatch (soft warning only)
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:37:06,720 - src.models.query_routing - INFO - Language: japanese (ja) → Model: Nova
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='気候変動とは何ですか？'
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='気候変動とは何ですか？'
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Net debug → original_query len=11, utf8_bytes=33
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Net debug → english_query len=11, utf8_bytes=33
2025-08-16 17:37:06,720 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:37:06,720 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:06,724 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:06,724 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:06,725 - src.models.climate_pipeline - INFO - ✓ Cache hit for japanese - returning cached response
2025-08-16 17:37:06,725 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380226717 time=0.006s model=nova faithfulness=0.950
2025-08-16 17:37:06,725 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=0.008s id=req_1755380226717 ip=127.0.0.1
INFO:     127.0.0.1:56041 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:37:07,936 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380227935 query_len=24 lang=de
2025-08-16 17:37:07,937 - src.webui.api.routers.chat - INFO - Language routing: detected=de model=nova
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - Processing query: 'Was ist der Klimawandel?...' in german (code: de)
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - Raw query repr: 'Was ist der Klimawandel?'
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - Router IN → language_name=german, language_code=de
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:37:07,937 - src.models.query_routing - INFO - Language: german (de) → Model: Nova
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - Router OUT → english_query='Was ist der Klimawandel?'
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Was ist der Klimawandel?'
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:37:07,937 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:37:07,937 - src.models.query_routing - INFO - Language: german (de) → Model: Nova
2025-08-16 17:37:07,937 - src.models.query_routing - INFO - Translating query from german to English
2025-08-16 17:37:07,937 - src.models.query_routing - INFO - Router NET IN → query repr='Was ist der Klimawandel?'
2025-08-16 17:37:09,159 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1221 status=OK request_id=ca2ad0ba-7f10-4963-b4b7-08118c1785bf
2025-08-16 17:37:09,160 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:37:09,160 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What is Climate Change?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. These changes can occur naturally, but the term is most often used to descr'
2025-08-16 17:37:09,160 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What is Climate Change?

Climate change refers to significant changes in global temperatures and weather patterns over time. These changes can occur naturally, but the term is most often used to descr'
2025-08-16 17:37:09,161 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What is Climate Change?

Climate change refers to significant changes in global temperatures and weather patterns over time. These changes can occur naturally, but the term is most often used to descr'
2025-08-16 17:37:09,161 - src.models.climate_pipeline - INFO - Net debug → original_query len=24, utf8_bytes=24
2025-08-16 17:37:09,161 - src.models.climate_pipeline - INFO - Net debug → english_query len=896, utf8_bytes=902
2025-08-16 17:37:09,161 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:37:09,161 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:09,164 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:09,164 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:09,185 - src.models.climate_pipeline - INFO - ✓ Cache hit for german - returning cached response
2025-08-16 17:37:09,186 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380227935 time=1.249s model=nova faithfulness=0.950
2025-08-16 17:37:09,186 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=1.251s id=req_1755380227935 ip=127.0.0.1
INFO:     127.0.0.1:56052 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:37:10,406 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380230403 query_len=26 lang=sv
2025-08-16 17:37:10,406 - src.webui.api.routers.chat - INFO - Language routing: detected=sv model=nova
2025-08-16 17:37:10,407 - src.models.climate_pipeline - INFO - Processing query: 'Vad är klimatförändringar?...' in swedish (code: sv)
2025-08-16 17:37:10,407 - src.models.climate_pipeline - INFO - Raw query repr: 'Vad är klimatförändringar?'
2025-08-16 17:37:10,408 - src.models.climate_pipeline - INFO - Router IN → language_name=swedish, language_code=sv
2025-08-16 17:37:10,408 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:37:10,408 - src.models.query_routing - INFO - Language: swedish (sv) → Model: Nova
2025-08-16 17:37:10,408 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:37:10,408 - src.models.climate_pipeline - INFO - Router OUT → english_query='Vad är klimatförändringar?'
2025-08-16 17:37:10,408 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Vad är klimatförändringar?'
2025-08-16 17:37:10,408 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:37:10,408 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:37:10,408 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:37:10,408 - src.models.query_routing - INFO - Language: swedish (sv) → Model: Nova
2025-08-16 17:37:10,408 - src.models.query_routing - INFO - Translating query from swedish to English
2025-08-16 17:37:10,408 - src.models.query_routing - INFO - Router NET IN → query repr='Vad är klimatförändringar?'
2025-08-16 17:37:11,409 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=999 status=OK request_id=a586fb0f-a3f4-4a6d-a1d0-c6de7b428f7a
2025-08-16 17:37:11,410 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:37:11,410 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What are climate changes?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. While climate change exists naturally, the term is most often used today '
2025-08-16 17:37:11,410 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What are climate changes?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate change exists naturally, the term is most often used today '
2025-08-16 17:37:11,410 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What are climate changes?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate change exists naturally, the term is most often used today '
2025-08-16 17:37:11,410 - src.models.climate_pipeline - INFO - Net debug → original_query len=26, utf8_bytes=29
2025-08-16 17:37:11,410 - src.models.climate_pipeline - INFO - Net debug → english_query len=779, utf8_bytes=779
2025-08-16 17:37:11,410 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:37:11,411 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:11,428 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:11,428 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:11,466 - src.models.climate_pipeline - INFO - ✓ Cache hit for swedish - returning cached response
2025-08-16 17:37:11,477 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380230403 time=1.071s model=nova faithfulness=0.950
2025-08-16 17:37:11,483 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=1.080s id=req_1755380230403 ip=127.0.0.1
INFO:     127.0.0.1:56078 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:37:12,708 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380232705 query_len=23 lang=da
2025-08-16 17:37:12,710 - src.webui.api.routers.chat - INFO - Language routing: detected=da model=nova
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - Processing query: 'Hvad er klimaændringer?...' in danish (code: da)
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - Raw query repr: 'Hvad er klimaændringer?'
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - Router IN → language_name=danish, language_code=da
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:37:12,711 - src.models.query_routing - INFO - Language: danish (da) → Model: Nova
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - Router OUT → english_query='Hvad er klimaændringer?'
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Hvad er klimaændringer?'
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:37:12,711 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:37:12,711 - src.models.query_routing - INFO - Language: danish (da) → Model: Nova
2025-08-16 17:37:12,711 - src.models.query_routing - INFO - Translating query from danish to English
2025-08-16 17:37:12,711 - src.models.query_routing - INFO - Router NET IN → query repr='Hvad er klimaændringer?'
2025-08-16 17:37:13,449 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=737 status=OK request_id=60e204cd-bbd1-4427-b3a7-c54654decb83
2025-08-16 17:37:13,449 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:37:13,449 - src.models.query_routing - INFO - Router NET OUT → english_query repr="What are climate changes?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. While climate variability has always been a natural part of Earth's histo"
2025-08-16 17:37:13,449 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What are climate changes?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate variability has always been a natural part of Earth's histo'
2025-08-16 17:37:13,450 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What are climate changes?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate variability has always been a natural part of Earth's histo'
2025-08-16 17:37:13,450 - src.models.climate_pipeline - INFO - Net debug → original_query len=23, utf8_bytes=24
2025-08-16 17:37:13,450 - src.models.climate_pipeline - INFO - Net debug → english_query len=538, utf8_bytes=538
2025-08-16 17:37:13,450 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:37:13,450 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:13,454 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:13,454 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:13,454 - src.models.climate_pipeline - INFO - Cache miss for danish query
2025-08-16 17:37:13,455 - src.models.climate_pipeline - INFO - Timing: cache=5.5ms
2025-08-16 17:37:13,455 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:37:13,455 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:37:13,455 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=da, history_len=0
2025-08-16 17:37:13,455 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='Hvad er klimaændringer?'
2025-08-16 17:37:13,456 - query_rewriter - INFO - Rewriter NET IN → expected_lang=da, user_query repr='Hvad er klimaændringer?', norm='Hvad er klimaændringer?'
2025-08-16 17:37:14,190 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=734 status=OK request_id=f6368e25-e75e-4b51-a699-171802ec00d0
2025-08-16 17:37:14,193 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is about climate change in Danish.","language":"da","expected_language":"da","language_match":true,"classification":"on-topic","rewrite_en":"What are climate changes?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:37:14,197 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:37:14,206 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='Hvad er klimaændringer?...' expected_lang=da detected_lang=da classification=on-topic language_match=True reason='User query is about climate change in Danish....'
2025-08-16 17:37:14,207 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='da', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:37:14,207 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What are climate changes?'
2025-08-16 17:37:14,207 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:37:14,207 - src.models.climate_pipeline - INFO - Timing: rewrite=751.7ms
2025-08-16 17:37:14,207 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:37:14,208 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:37:14,208 - src.models.climate_pipeline - INFO - Timing: guards=0.1ms
2025-08-16 17:37:14,208 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:37:14,208 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:37:14,208 - src.models.retrieval - INFO - Query embedding IN: query_len=25 chars, query_repr='What are climate changes?...'
2025-08-16 17:37:15,048 - src.models.retrieval - INFO - dep=query_embed op=encode ms=840 dense_dim=1024 sparse_tokens=5
2025-08-16 17:37:15,125 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=75 status=OK
2025-08-16 17:37:15,125 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=75 total_ms=75
2025-08-16 17:37:15,322 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=196 status=OK
2025-08-16 17:37:15,322 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:37:15,322 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=197 total_ms=197
2025-08-16 17:37:15,325 - src.models.retrieval - INFO - dep=mmr_embed used_index=8 used_cache=0 embedded=0 ms=0 n_docs=8 valid_vecs=8 q_embed_ms=0
2025-08-16 17:37:15,325 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=10889 n_docs=8
2025-08-16 17:37:15,465 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:37:15,478 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=152.3 status=OK
2025-08-16 17:37:15,479 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.251038074, 'rerank_score': 0.9986904, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.228502974, 'rerank_score': 0.9981541, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.234236374, 'rerank_score': 0.9980882, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.234831899, 'rerank_score': 0.9956176, 'has_values': True}, {'title': 'Climate Change 2021 Summary For All', 'pinecone_score': 0.252884656, 'rerank_score': 0.99341017, 'has_values': True}]
2025-08-16 17:37:15,479 - src.models.retrieval - INFO - q='What are climate changes?', base=8, kept_pre=8, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.60, delta=0.100, max_sim_pre=0.253, p50_sim_pre=0.234, p95_sim_pre=0.253, blocked_base=0, dropped_top2=[{'segment_id': '18', 'title': 'Adapting To Climate Change A Risk Based Guide For Local Governments', 'score': 0.25423113}, {'segment_id': '386', 'title': "Canada's Changing Climate Report 2019", 'score': 0.25312182}]
2025-08-16 17:37:15,480 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:37:15,480 - src.models.climate_pipeline - INFO - Timing: retrieval=1271.8ms
2025-08-16 17:37:15,480 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:37:15,480 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:37:15,480 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:15,481 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:15,482 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:15,482 - src.models.gen_response_unified - INFO - Successfully processed 5 documents
2025-08-16 17:37:15,482 - src.models.gen_response_unified - INFO - Successfully processed 5 documents for nova
2025-08-16 17:37:18,041 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=2558 status=OK request_id=fc298bf3-3a94-4ea5-b16c-24d0a1c98824
2025-08-16 17:37:18,063 - src.models.gen_response_unified - INFO - nova response cached successfully
2025-08-16 17:37:18,064 - src.models.gen_response_unified - INFO - nova response generation complete
2025-08-16 17:37:18,064 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:37:18,064 - src.models.climate_pipeline - INFO - Timing: generation=2584.3ms
2025-08-16 17:37:18,064 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:37:19,452 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1387 status=OK request_id=ec650a89-a9aa-4f7a-ac47-864468f94e34
2025-08-16 17:37:19,452 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:37:19,452 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:37:19,453 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:37:19,453 - src.models.climate_pipeline - INFO - Timing: faithfulness=1388.6ms
2025-08-16 17:37:19,453 - src.models.climate_pipeline - INFO - Step 8: Translating response to danish (code=da)
2025-08-16 17:37:26,704 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=7251 status=OK request_id=5c845ce5-1495-4d93-9710-c4f7e8c7847f
2025-08-16 17:37:26,704 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to danish
2025-08-16 17:37:26,704 - src.models.climate_pipeline - INFO - Timing: translation=7251.8ms
2025-08-16 17:37:26,705 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:26,707 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:26,707 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:26,709 - src.models.climate_pipeline - INFO - ✓ Response cached in danish
2025-08-16 17:37:26,712 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:37:26,715 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.2 rewrite=751.7 guards=0.1 retrieval=1271.8 generation=2584.3 faithfulness=1388.6 translation=7251.8 total=13993.6
2025-08-16 17:37:26,715 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 13.99s
2025-08-16 17:37:26,716 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380232705 time=14.008s model=nova faithfulness=0.950
2025-08-16 17:37:26,717 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=14.011s id=req_1755380232705 ip=127.0.0.1
INFO:     127.0.0.1:56101 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:37:27,930 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380247929 query_len=22 lang=no
2025-08-16 17:37:27,930 - src.webui.api.routers.chat - INFO - Language routing: detected=no model=nova
2025-08-16 17:37:27,930 - src.models.climate_pipeline - INFO - Processing query: 'Hva er klimaendringer?...' in norwegian (code: no)
2025-08-16 17:37:27,930 - src.models.climate_pipeline - INFO - Raw query repr: 'Hva er klimaendringer?'
2025-08-16 17:37:27,930 - src.models.climate_pipeline - INFO - Router IN → language_name=norwegian, language_code=no
2025-08-16 17:37:27,930 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:37:27,931 - src.models.query_routing - INFO - Language: norwegian (no) → Model: Nova
2025-08-16 17:37:27,931 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:37:27,931 - src.models.climate_pipeline - INFO - Router OUT → english_query='Hva er klimaendringer?'
2025-08-16 17:37:27,931 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Hva er klimaendringer?'
2025-08-16 17:37:27,931 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:37:27,931 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:37:27,931 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:37:27,931 - src.models.query_routing - INFO - Language: norwegian (no) → Model: Nova
2025-08-16 17:37:27,931 - src.models.query_routing - INFO - Translating query from norwegian to English
2025-08-16 17:37:27,931 - src.models.query_routing - INFO - Router NET IN → query repr='Hva er klimaendringer?'
2025-08-16 17:37:28,725 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=794 status=OK request_id=0065d76c-e7aa-4f55-b2d8-404884086281
2025-08-16 17:37:28,726 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:37:28,726 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What are climate changes?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. While climate variability is a natural phenomenon, the term "climate chan'
2025-08-16 17:37:28,726 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What are climate changes?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate variability is a natural phenomenon, the term "climate chan'
2025-08-16 17:37:28,726 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What are climate changes?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate variability is a natural phenomenon, the term "climate chan'
2025-08-16 17:37:28,726 - src.models.climate_pipeline - INFO - Net debug → original_query len=22, utf8_bytes=22
2025-08-16 17:37:28,726 - src.models.climate_pipeline - INFO - Net debug → english_query len=644, utf8_bytes=644
2025-08-16 17:37:28,726 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:37:28,726 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:28,727 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:28,727 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:28,728 - src.models.climate_pipeline - INFO - Cache miss for norwegian query
2025-08-16 17:37:28,729 - src.models.climate_pipeline - INFO - Timing: cache=2.7ms
2025-08-16 17:37:28,729 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:37:28,729 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:37:28,729 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=no, history_len=0
2025-08-16 17:37:28,729 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='Hva er klimaendringer?'
2025-08-16 17:37:28,729 - query_rewriter - INFO - Rewriter NET IN → expected_lang=no, user_query repr='Hva er klimaendringer?', norm='Hva er klimaendringer?'
2025-08-16 17:37:29,480 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=750 status=OK request_id=69645d3d-33cd-46a3-9b21-f28205ceeca8
2025-08-16 17:37:29,480 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Norwegian and contains climate-related terms.","language":"no","expected_language":"no","language_match":true,"classification":"on-topic","rewrite_en":"What are climate changes?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:37:29,480 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:37:29,481 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='Hva er klimaendringer?...' expected_lang=no detected_lang=no classification=on-topic language_match=True reason='User query is in Norwegian and contains climate-related terms....'
2025-08-16 17:37:29,481 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='no', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:37:29,481 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What are climate changes?'
2025-08-16 17:37:29,481 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:37:29,481 - src.models.climate_pipeline - INFO - Timing: rewrite=751.8ms
2025-08-16 17:37:29,481 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:37:29,481 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:37:29,481 - src.models.climate_pipeline - INFO - Timing: guards=0.0ms
2025-08-16 17:37:29,481 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:37:29,481 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:37:29,481 - src.models.retrieval - INFO - Query embedding IN: query_len=25 chars, query_repr='What are climate changes?...'
2025-08-16 17:37:30,045 - src.models.retrieval - INFO - dep=query_embed op=encode ms=564 dense_dim=1024 sparse_tokens=5
2025-08-16 17:37:30,108 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=61 status=OK
2025-08-16 17:37:30,108 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=61 total_ms=61
2025-08-16 17:37:30,445 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=336 status=OK
2025-08-16 17:37:30,445 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:37:30,445 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=337 total_ms=337
2025-08-16 17:37:30,447 - src.models.retrieval - INFO - dep=mmr_embed used_index=8 used_cache=0 embedded=0 ms=0 n_docs=8 valid_vecs=8 q_embed_ms=0
2025-08-16 17:37:30,448 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=10889 n_docs=8
2025-08-16 17:37:30,591 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:37:30,595 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=146.6 status=OK
2025-08-16 17:37:30,596 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.251038074, 'rerank_score': 0.9986904, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.228502974, 'rerank_score': 0.9981541, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.234236374, 'rerank_score': 0.9980882, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.234831899, 'rerank_score': 0.9956176, 'has_values': True}, {'title': 'Climate Change 2021 Summary For All', 'pinecone_score': 0.252884656, 'rerank_score': 0.99341017, 'has_values': True}]
2025-08-16 17:37:30,596 - src.models.retrieval - INFO - q='What are climate changes?', base=8, kept_pre=8, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.60, delta=0.100, max_sim_pre=0.253, p50_sim_pre=0.234, p95_sim_pre=0.253, blocked_base=0, dropped_top2=[{'segment_id': '18', 'title': 'Adapting To Climate Change A Risk Based Guide For Local Governments', 'score': 0.25423113}, {'segment_id': '386', 'title': "Canada's Changing Climate Report 2019", 'score': 0.25312182}]
2025-08-16 17:37:30,596 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:37:30,596 - src.models.climate_pipeline - INFO - Timing: retrieval=1115.6ms
2025-08-16 17:37:30,596 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:37:30,597 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:37:30,597 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:30,604 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:30,604 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:30,605 - src.models.gen_response_unified - INFO - Cache hit for nova - returning cached response
2025-08-16 17:37:30,605 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:37:30,605 - src.models.climate_pipeline - INFO - Timing: generation=8.8ms
2025-08-16 17:37:30,605 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:37:32,436 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1830 status=OK request_id=f772a79f-cbc9-4579-8847-5bced5b70b4f
2025-08-16 17:37:32,436 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:37:32,436 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:37:32,436 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:37:32,436 - src.models.climate_pipeline - INFO - Timing: faithfulness=1831.1ms
2025-08-16 17:37:32,436 - src.models.climate_pipeline - INFO - Step 8: Translating response to norwegian (code=no)
2025-08-16 17:37:39,202 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=6765 status=OK request_id=d65f301b-ee41-4ac6-82e5-0d13ccc103fc
2025-08-16 17:37:39,202 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to norwegian
2025-08-16 17:37:39,202 - src.models.climate_pipeline - INFO - Timing: translation=6765.9ms
2025-08-16 17:37:39,202 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:39,206 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:39,206 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:39,207 - src.models.climate_pipeline - INFO - ✓ Response cached in norwegian
2025-08-16 17:37:39,207 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:37:39,208 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.2 rewrite=751.8 guards=0.0 retrieval=1115.6 generation=8.8 faithfulness=1831.1 translation=6765.9 total=11271.9
2025-08-16 17:37:39,208 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 11.27s
2025-08-16 17:37:39,208 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380247929 time=11.278s model=nova faithfulness=0.950
2025-08-16 17:37:39,209 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=11.281s id=req_1755380247929 ip=127.0.0.1
INFO:     127.0.0.1:56236 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:37:40,419 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380260418 query_len=23 lang=fi
2025-08-16 17:37:40,419 - src.webui.api.routers.chat - INFO - Language routing: detected=fi model=nova
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - Processing query: 'Mitä on ilmastonmuutos?...' in finnish (code: fi)
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - Raw query repr: 'Mitä on ilmastonmuutos?'
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - Router IN → language_name=finnish, language_code=fi
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:37:40,419 - src.models.query_routing - INFO - Language: finnish (fi) → Model: Nova
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - Router OUT → english_query='Mitä on ilmastonmuutos?'
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Mitä on ilmastonmuutos?'
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - Timing: routing=0.1ms
2025-08-16 17:37:40,419 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:37:40,419 - src.models.query_routing - INFO - Language: finnish (fi) → Model: Nova
2025-08-16 17:37:40,419 - src.models.query_routing - INFO - Translating query from finnish to English
2025-08-16 17:37:40,419 - src.models.query_routing - INFO - Router NET IN → query repr='Mitä on ilmastonmuutos?'
2025-08-16 17:37:41,303 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=883 status=OK request_id=76fbde11-859d-4832-8f9f-5f42b26517ce
2025-08-16 17:37:41,303 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:37:41,303 - src.models.query_routing - INFO - Router NET OUT → english_query repr="What is climate change?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. While climate variability has existed throughout Earth's history, the term "
2025-08-16 17:37:41,303 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate variability has existed throughout Earth's history, the term '
2025-08-16 17:37:41,303 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate variability has existed throughout Earth's history, the term '
2025-08-16 17:37:41,303 - src.models.climate_pipeline - INFO - Net debug → original_query len=23, utf8_bytes=24
2025-08-16 17:37:41,303 - src.models.climate_pipeline - INFO - Net debug → english_query len=758, utf8_bytes=758
2025-08-16 17:37:41,303 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:37:41,303 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:41,315 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:41,315 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:41,315 - src.models.climate_pipeline - INFO - Cache miss for finnish query
2025-08-16 17:37:41,316 - src.models.climate_pipeline - INFO - Timing: cache=12.5ms
2025-08-16 17:37:41,316 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:37:41,316 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:37:41,316 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=fi, history_len=0
2025-08-16 17:37:41,316 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='Mitä on ilmastonmuutos?'
2025-08-16 17:37:41,316 - query_rewriter - INFO - Rewriter NET IN → expected_lang=fi, user_query repr='Mitä on ilmastonmuutos?', norm='Mitä on ilmastonmuutos?'
2025-08-16 17:37:41,916 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=600 status=OK request_id=53c91e6c-7d62-4e59-9d04-23b3c341c28b
2025-08-16 17:37:41,916 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Finnish and asks about climate change.","language":"fi","expected_language":"fi","language_match":true,"classification":"on-topic","rewrite_en":"What is climate change?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:37:41,916 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:37:41,916 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='Mitä on ilmastonmuutos?...' expected_lang=fi detected_lang=fi classification=on-topic language_match=True reason='User query is in Finnish and asks about climate change....'
2025-08-16 17:37:41,916 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='fi', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:37:41,917 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What is climate change?'
2025-08-16 17:37:41,917 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:37:41,917 - src.models.climate_pipeline - INFO - Timing: rewrite=600.9ms
2025-08-16 17:37:41,917 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:37:41,917 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:37:41,917 - src.models.climate_pipeline - INFO - Timing: guards=0.0ms
2025-08-16 17:37:41,917 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:37:41,917 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:37:41,917 - src.models.retrieval - INFO - Query embedding IN: query_len=23 chars, query_repr='What is climate change?...'
2025-08-16 17:37:42,473 - src.models.retrieval - INFO - dep=query_embed op=encode ms=556 dense_dim=1024 sparse_tokens=5
2025-08-16 17:37:42,521 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=48 status=OK
2025-08-16 17:37:42,522 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=48 total_ms=48
2025-08-16 17:37:42,774 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=252 status=OK
2025-08-16 17:37:42,775 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:37:42,775 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=253 total_ms=253
2025-08-16 17:37:42,779 - src.models.retrieval - INFO - dep=mmr_embed used_index=9 used_cache=0 embedded=0 ms=0 n_docs=9 valid_vecs=9 q_embed_ms=0
2025-08-16 17:37:42,779 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=11944 n_docs=9
2025-08-16 17:37:42,927 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:37:42,946 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=166.4 status=OK
2025-08-16 17:37:42,947 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.280184954, 'rerank_score': 0.9995272, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.26793474, 'rerank_score': 0.9994536, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.271402389, 'rerank_score': 0.9993857, 'has_values': True}, {'title': "Report For Action Toronto's Climate Change Readiness Updates Oncommitments And A", 'pinecone_score': 0.274087071, 'rerank_score': 0.9984452, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.270209789, 'rerank_score': 0.9980276, 'has_values': True}]
2025-08-16 17:37:42,947 - src.models.retrieval - INFO - q='What is climate change?', base=9, kept_pre=9, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.95, delta=0.100, max_sim_pre=0.280, p50_sim_pre=0.270, p95_sim_pre=0.280, blocked_base=0, dropped_top2=[]
2025-08-16 17:37:42,947 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:37:42,947 - src.models.climate_pipeline - INFO - Timing: retrieval=1030.5ms
2025-08-16 17:37:42,947 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:37:42,947 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:37:42,947 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:42,950 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:42,950 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:42,956 - src.models.gen_response_unified - INFO - Cache hit for nova - returning cached response
2025-08-16 17:37:42,957 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:37:42,957 - src.models.climate_pipeline - INFO - Timing: generation=9.7ms
2025-08-16 17:37:42,957 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:37:44,887 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1928 status=OK request_id=602fd4c6-5453-47d1-a0c3-f3e87b2db7c9
2025-08-16 17:37:44,889 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:37:44,889 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:37:44,889 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:37:44,889 - src.models.climate_pipeline - INFO - Timing: faithfulness=1932.0ms
2025-08-16 17:37:44,889 - src.models.climate_pipeline - INFO - Step 8: Translating response to finnish (code=fi)
2025-08-16 17:37:53,794 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=8904 status=OK request_id=47633af0-ae31-4bd7-b952-f95d28de8260
2025-08-16 17:37:53,795 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to finnish
2025-08-16 17:37:53,795 - src.models.climate_pipeline - INFO - Timing: translation=8905.5ms
2025-08-16 17:37:53,795 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:53,806 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:53,806 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:53,807 - src.models.climate_pipeline - INFO - ✓ Response cached in finnish
2025-08-16 17:37:53,808 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:37:53,811 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.1 rewrite=600.9 guards=0.0 retrieval=1030.5 generation=9.7 faithfulness=1932.0 translation=8905.5 total=13375.9
2025-08-16 17:37:53,811 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 13.38s
2025-08-16 17:37:53,812 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380260418 time=13.393s model=nova faithfulness=0.950
2025-08-16 17:37:53,812 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=13.395s id=req_1755380260418 ip=127.0.0.1
INFO:     127.0.0.1:56346 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:37:55,029 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380275027 query_len=31 lang=it
2025-08-16 17:37:55,029 - src.webui.api.routers.chat - INFO - Language routing: detected=it model=nova
2025-08-16 17:37:55,029 - src.models.climate_pipeline - INFO - Processing query: 'Cos'è il cambiamento climatico?...' in italian (code: it)
2025-08-16 17:37:55,029 - src.models.climate_pipeline - INFO - Raw query repr: "Cos'è il cambiamento climatico?"
2025-08-16 17:37:55,029 - src.models.climate_pipeline - INFO - Router IN → language_name=italian, language_code=it
2025-08-16 17:37:55,029 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:37:55,030 - src.models.query_routing - INFO - Language: italian (it) → Model: Nova
2025-08-16 17:37:55,030 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:37:55,030 - src.models.climate_pipeline - INFO - Router OUT → english_query='Cos'è il cambiamento climatico?'
2025-08-16 17:37:55,030 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Cos'è il cambiamento climatico?'
2025-08-16 17:37:55,030 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:37:55,030 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:37:55,030 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:37:55,030 - src.models.query_routing - INFO - Language: italian (it) → Model: Nova
2025-08-16 17:37:55,030 - src.models.query_routing - INFO - Translating query from italian to English
2025-08-16 17:37:55,030 - src.models.query_routing - INFO - Router NET IN → query repr="Cos'è il cambiamento climatico?"
2025-08-16 17:37:55,945 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=914 status=OK request_id=efe6b8c8-9558-420b-b502-8f1364e2202f
2025-08-16 17:37:55,945 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:37:55,945 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What is climate change?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. These changes can occur naturally, but the term is most often used to descr'
2025-08-16 17:37:55,945 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. These changes can occur naturally, but the term is most often used to descr'
2025-08-16 17:37:55,945 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. These changes can occur naturally, but the term is most often used to descr'
2025-08-16 17:37:55,945 - src.models.climate_pipeline - INFO - Net debug → original_query len=31, utf8_bytes=32
2025-08-16 17:37:55,945 - src.models.climate_pipeline - INFO - Net debug → english_query len=611, utf8_bytes=611
2025-08-16 17:37:55,945 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:37:55,945 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:55,953 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:55,953 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:55,954 - src.models.climate_pipeline - INFO - Cache miss for italian query
2025-08-16 17:37:55,954 - src.models.climate_pipeline - INFO - Timing: cache=9.1ms
2025-08-16 17:37:55,954 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:37:55,954 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:37:55,954 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=it, history_len=0
2025-08-16 17:37:55,954 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='Cos'è il cambiamento climatico?'
2025-08-16 17:37:55,954 - query_rewriter - INFO - Rewriter NET IN → expected_lang=it, user_query repr="Cos'è il cambiamento climatico?", norm="Cos'è il cambiamento climatico?"
2025-08-16 17:37:56,535 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=580 status=OK request_id=9bd3e8d3-b430-4a25-abe2-b3bc84b76b0d
2025-08-16 17:37:56,536 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Italian and asks about climate change.","language":"it","expected_language":"it","language_match":true,"classification":"on-topic","rewrite_en":"What is climate change?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:37:56,536 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:37:56,536 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='Cos'è il cambiamento climatico?...' expected_lang=it detected_lang=it classification=on-topic language_match=True reason='User query is in Italian and asks about climate change....'
2025-08-16 17:37:56,536 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='it', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:37:56,536 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What is climate change?'
2025-08-16 17:37:56,536 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:37:56,536 - src.models.climate_pipeline - INFO - Timing: rewrite=581.7ms
2025-08-16 17:37:56,536 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:37:56,536 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:37:56,536 - src.models.climate_pipeline - INFO - Timing: guards=0.0ms
2025-08-16 17:37:56,536 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:37:56,536 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:37:56,536 - src.models.retrieval - INFO - Query embedding IN: query_len=23 chars, query_repr='What is climate change?...'
2025-08-16 17:37:57,117 - src.models.retrieval - INFO - dep=query_embed op=encode ms=581 dense_dim=1024 sparse_tokens=5
2025-08-16 17:37:57,185 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=66 status=OK
2025-08-16 17:37:57,185 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=66 total_ms=66
2025-08-16 17:37:57,365 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=179 status=OK
2025-08-16 17:37:57,365 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:37:57,365 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=179 total_ms=179
2025-08-16 17:37:57,367 - src.models.retrieval - INFO - dep=mmr_embed used_index=9 used_cache=0 embedded=0 ms=0 n_docs=9 valid_vecs=9 q_embed_ms=0
2025-08-16 17:37:57,368 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=11944 n_docs=9
2025-08-16 17:37:57,546 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:37:57,550 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=182.1 status=OK
2025-08-16 17:37:57,551 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.280184954, 'rerank_score': 0.9995272, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.26793474, 'rerank_score': 0.9994536, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.271402389, 'rerank_score': 0.9993857, 'has_values': True}, {'title': "Report For Action Toronto's Climate Change Readiness Updates Oncommitments And A", 'pinecone_score': 0.274087071, 'rerank_score': 0.9984452, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.270209789, 'rerank_score': 0.9980276, 'has_values': True}]
2025-08-16 17:37:57,551 - src.models.retrieval - INFO - q='What is climate change?', base=9, kept_pre=9, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.95, delta=0.100, max_sim_pre=0.280, p50_sim_pre=0.270, p95_sim_pre=0.280, blocked_base=0, dropped_top2=[]
2025-08-16 17:37:57,552 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:37:57,552 - src.models.climate_pipeline - INFO - Timing: retrieval=1015.7ms
2025-08-16 17:37:57,552 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:37:57,552 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:37:57,552 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:37:57,553 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:37:57,553 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:37:57,554 - src.models.gen_response_unified - INFO - Cache hit for nova - returning cached response
2025-08-16 17:37:57,554 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:37:57,554 - src.models.climate_pipeline - INFO - Timing: generation=1.9ms
2025-08-16 17:37:57,554 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:37:59,393 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1838 status=OK request_id=50f75988-bf34-4bdb-aa23-c61495a39152
2025-08-16 17:37:59,401 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:37:59,401 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:37:59,401 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:37:59,401 - src.models.climate_pipeline - INFO - Timing: faithfulness=1847.3ms
2025-08-16 17:37:59,401 - src.models.climate_pipeline - INFO - Step 8: Translating response to italian (code=it)
2025-08-16 17:38:04,428 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=5026 status=OK request_id=d35e515b-a052-4b0c-a76d-a08baaee7222
2025-08-16 17:38:04,447 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to italian
2025-08-16 17:38:04,447 - src.models.climate_pipeline - INFO - Timing: translation=5045.5ms
2025-08-16 17:38:04,447 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:04,474 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:04,475 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:04,499 - src.models.climate_pipeline - INFO - ✓ Response cached in italian
2025-08-16 17:38:04,511 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:38:04,514 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.2 rewrite=581.7 guards=0.0 retrieval=1015.7 generation=1.9 faithfulness=1847.3 translation=5045.5 total=9417.6
2025-08-16 17:38:04,514 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 9.42s
2025-08-16 17:38:04,517 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380275027 time=9.488s model=nova faithfulness=0.950
2025-08-16 17:38:04,520 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=9.493s id=req_1755380275027 ip=127.0.0.1
INFO:     127.0.0.1:56473 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:38:05,741 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380285740 query_len=26 lang=pt
2025-08-16 17:38:05,742 - src.webui.api.routers.chat - INFO - Language routing: detected=pt model=nova
2025-08-16 17:38:05,742 - src.models.climate_pipeline - INFO - Processing query: 'O que é mudança climática?...' in portuguese (code: pt)
2025-08-16 17:38:05,742 - src.models.climate_pipeline - INFO - Raw query repr: 'O que é mudança climática?'
2025-08-16 17:38:05,742 - src.models.climate_pipeline - INFO - Router IN → language_name=portuguese, language_code=pt
2025-08-16 17:38:05,742 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:38:05,742 - src.models.query_routing - INFO - Language: portuguese (pt) → Model: Nova
2025-08-16 17:38:05,743 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:38:05,743 - src.models.climate_pipeline - INFO - Router OUT → english_query='O que é mudança climática?'
2025-08-16 17:38:05,743 - src.models.climate_pipeline - INFO - Router OUT → processed_query='O que é mudança climática?'
2025-08-16 17:38:05,743 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:38:05,743 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:38:05,743 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:38:05,743 - src.models.query_routing - INFO - Language: portuguese (pt) → Model: Nova
2025-08-16 17:38:05,743 - src.models.query_routing - INFO - Translating query from portuguese to English
2025-08-16 17:38:05,743 - src.models.query_routing - INFO - Router NET IN → query repr='O que é mudança climática?'
2025-08-16 17:38:06,430 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=687 status=OK request_id=90c43c50-746a-4948-8293-8bc461db5dec
2025-08-16 17:38:06,431 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:38:06,431 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What is climate change?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. Long-term shifts in temperature and weather patterns are primarily driven b'
2025-08-16 17:38:06,431 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. Long-term shifts in temperature and weather patterns are primarily driven b'
2025-08-16 17:38:06,431 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. Long-term shifts in temperature and weather patterns are primarily driven b'
2025-08-16 17:38:06,431 - src.models.climate_pipeline - INFO - Net debug → original_query len=26, utf8_bytes=29
2025-08-16 17:38:06,431 - src.models.climate_pipeline - INFO - Net debug → english_query len=687, utf8_bytes=691
2025-08-16 17:38:06,431 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:38:06,431 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:06,432 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:06,432 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:06,433 - src.models.climate_pipeline - INFO - Cache miss for portuguese query
2025-08-16 17:38:06,433 - src.models.climate_pipeline - INFO - Timing: cache=2.6ms
2025-08-16 17:38:06,434 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:38:06,434 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:38:06,434 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=pt, history_len=0
2025-08-16 17:38:06,434 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='O que é mudança climática?'
2025-08-16 17:38:06,434 - query_rewriter - INFO - Rewriter NET IN → expected_lang=pt, user_query repr='O que é mudança climática?', norm='O que é mudança climática?'
2025-08-16 17:38:07,064 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=630 status=OK request_id=d7655793-1246-4bcd-ab92-916db79bde86
2025-08-16 17:38:07,065 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Portuguese and asks about climate change.","language":"pt","expected_language":"pt","language_match":true,"classification":"on-topic","rewrite_en":"What is climate change?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:38:07,065 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:38:07,065 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='O que é mudança climática?...' expected_lang=pt detected_lang=pt classification=on-topic language_match=True reason='User query is in Portuguese and asks about climate change....'
2025-08-16 17:38:07,065 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='pt', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:38:07,065 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What is climate change?'
2025-08-16 17:38:07,065 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:38:07,065 - src.models.climate_pipeline - INFO - Timing: rewrite=631.3ms
2025-08-16 17:38:07,065 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:38:07,065 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:38:07,065 - src.models.climate_pipeline - INFO - Timing: guards=0.0ms
2025-08-16 17:38:07,065 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:38:07,065 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:38:07,065 - src.models.retrieval - INFO - Query embedding IN: query_len=23 chars, query_repr='What is climate change?...'
2025-08-16 17:38:07,626 - src.models.retrieval - INFO - dep=query_embed op=encode ms=560 dense_dim=1024 sparse_tokens=5
2025-08-16 17:38:07,667 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=40 status=OK
2025-08-16 17:38:07,668 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=41 total_ms=41
2025-08-16 17:38:07,801 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=132 status=OK
2025-08-16 17:38:07,801 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:38:07,801 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=133 total_ms=133
2025-08-16 17:38:07,803 - src.models.retrieval - INFO - dep=mmr_embed used_index=9 used_cache=0 embedded=0 ms=0 n_docs=9 valid_vecs=9 q_embed_ms=0
2025-08-16 17:38:07,804 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=11944 n_docs=9
2025-08-16 17:38:07,961 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:38:07,966 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=161.8 status=OK
2025-08-16 17:38:07,969 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.280184954, 'rerank_score': 0.9995272, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.26793474, 'rerank_score': 0.9994536, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.271402389, 'rerank_score': 0.9993857, 'has_values': True}, {'title': "Report For Action Toronto's Climate Change Readiness Updates Oncommitments And A", 'pinecone_score': 0.274087071, 'rerank_score': 0.9984452, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.270209789, 'rerank_score': 0.9980276, 'has_values': True}]
2025-08-16 17:38:07,970 - src.models.retrieval - INFO - q='What is climate change?', base=9, kept_pre=9, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.95, delta=0.100, max_sim_pre=0.280, p50_sim_pre=0.270, p95_sim_pre=0.280, blocked_base=0, dropped_top2=[]
2025-08-16 17:38:07,970 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:38:07,970 - src.models.climate_pipeline - INFO - Timing: retrieval=905.4ms
2025-08-16 17:38:07,970 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:38:07,971 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:38:07,971 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:07,973 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:07,973 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:07,974 - src.models.gen_response_unified - INFO - Cache hit for nova - returning cached response
2025-08-16 17:38:07,974 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:38:07,974 - src.models.climate_pipeline - INFO - Timing: generation=3.5ms
2025-08-16 17:38:07,974 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:38:09,750 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1775 status=OK request_id=d657c33f-39f4-4e12-a072-d4d24e53ccbc
2025-08-16 17:38:09,751 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:38:09,751 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:38:09,751 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:38:09,751 - src.models.climate_pipeline - INFO - Timing: faithfulness=1777.1ms
2025-08-16 17:38:09,751 - src.models.climate_pipeline - INFO - Step 8: Translating response to portuguese (code=pt)
2025-08-16 17:38:13,593 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=3841 status=OK request_id=1fa1359e-2c0c-4a9b-b890-c038278cc358
2025-08-16 17:38:13,601 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to portuguese
2025-08-16 17:38:13,602 - src.models.climate_pipeline - INFO - Timing: translation=3850.4ms
2025-08-16 17:38:13,602 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:13,659 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:13,659 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:13,689 - src.models.climate_pipeline - INFO - ✓ Response cached in portuguese
2025-08-16 17:38:13,700 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:38:13,710 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.2 rewrite=631.3 guards=0.0 retrieval=905.4 generation=3.5 faithfulness=1777.1 translation=3850.4 total=7859.4
2025-08-16 17:38:13,711 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 7.86s
2025-08-16 17:38:13,722 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380285740 time=7.980s model=nova faithfulness=0.950
2025-08-16 17:38:13,737 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=7.996s id=req_1755380285740 ip=127.0.0.1
INFO:     127.0.0.1:56575 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:38:15,039 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380295037 query_len=19 lang=hu
2025-08-16 17:38:15,039 - src.webui.api.routers.chat - INFO - Language routing: detected=hu model=nova
2025-08-16 17:38:15,039 - src.models.climate_pipeline - INFO - Processing query: 'Mi a klímaváltozás?...' in hungarian (code: hu)
2025-08-16 17:38:15,039 - src.models.climate_pipeline - INFO - Raw query repr: 'Mi a klímaváltozás?'
2025-08-16 17:38:15,040 - src.models.climate_pipeline - INFO - Router IN → language_name=hungarian, language_code=hu
2025-08-16 17:38:15,040 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:38:15,040 - src.models.query_routing - INFO - Language: hungarian (hu) → Model: Nova
2025-08-16 17:38:15,040 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:38:15,040 - src.models.climate_pipeline - INFO - Router OUT → english_query='Mi a klímaváltozás?'
2025-08-16 17:38:15,040 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Mi a klímaváltozás?'
2025-08-16 17:38:15,040 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:38:15,040 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:38:15,040 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:38:15,040 - src.models.query_routing - INFO - Language: hungarian (hu) → Model: Nova
2025-08-16 17:38:15,040 - src.models.query_routing - INFO - Translating query from hungarian to English
2025-08-16 17:38:15,040 - src.models.query_routing - INFO - Router NET IN → query repr='Mi a klímaváltozás?'
2025-08-16 17:38:15,259 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=218 status=OK request_id=909310ac-163a-47f3-9a9a-f286f4062f10
2025-08-16 17:38:15,259 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:38:15,259 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What is climate change?'
2025-08-16 17:38:15,259 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What is climate change?'
2025-08-16 17:38:15,259 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What is climate change?'
2025-08-16 17:38:15,259 - src.models.climate_pipeline - INFO - Net debug → original_query len=19, utf8_bytes=22
2025-08-16 17:38:15,259 - src.models.climate_pipeline - INFO - Net debug → english_query len=23, utf8_bytes=23
2025-08-16 17:38:15,259 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:38:15,259 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:15,275 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:15,275 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:15,275 - src.models.climate_pipeline - INFO - Cache miss for hungarian query
2025-08-16 17:38:15,276 - src.models.climate_pipeline - INFO - Timing: cache=17.1ms
2025-08-16 17:38:15,276 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:38:15,276 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:38:15,276 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=hu, history_len=0
2025-08-16 17:38:15,276 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='Mi a klímaváltozás?'
2025-08-16 17:38:15,276 - query_rewriter - INFO - Rewriter NET IN → expected_lang=hu, user_query repr='Mi a klímaváltozás?', norm='Mi a klímaváltozás?'
2025-08-16 17:38:15,923 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=645 status=OK request_id=05c7c129-6e00-41ab-a88b-d1c16706ab89
2025-08-16 17:38:15,923 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Hungarian and asks about climate change.","language":"hu","expected_language":"hu","language_match":true,"classification":"on-topic","rewrite_en":"What is climate change?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:38:15,923 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:38:15,923 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='Mi a klímaváltozás?...' expected_lang=hu detected_lang=hu classification=on-topic language_match=True reason='User query is in Hungarian and asks about climate change....'
2025-08-16 17:38:15,923 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='hu', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:38:15,923 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What is climate change?'
2025-08-16 17:38:15,923 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:38:15,923 - src.models.climate_pipeline - INFO - Timing: rewrite=646.8ms
2025-08-16 17:38:15,923 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:38:15,923 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:38:15,923 - src.models.climate_pipeline - INFO - Timing: guards=0.0ms
2025-08-16 17:38:15,923 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:38:15,923 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:38:15,923 - src.models.retrieval - INFO - Query embedding IN: query_len=23 chars, query_repr='What is climate change?...'
2025-08-16 17:38:16,502 - src.models.retrieval - INFO - dep=query_embed op=encode ms=578 dense_dim=1024 sparse_tokens=5
2025-08-16 17:38:16,555 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=52 status=OK
2025-08-16 17:38:16,555 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=52 total_ms=52
2025-08-16 17:38:16,775 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=219 status=OK
2025-08-16 17:38:16,775 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:38:16,775 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=219 total_ms=219
2025-08-16 17:38:16,778 - src.models.retrieval - INFO - dep=mmr_embed used_index=9 used_cache=0 embedded=0 ms=0 n_docs=9 valid_vecs=9 q_embed_ms=0
2025-08-16 17:38:16,779 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=11944 n_docs=9
2025-08-16 17:38:16,971 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:38:16,975 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=195.4 status=OK
2025-08-16 17:38:16,977 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.280184954, 'rerank_score': 0.9995272, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.26793474, 'rerank_score': 0.9994536, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.271402389, 'rerank_score': 0.9993857, 'has_values': True}, {'title': "Report For Action Toronto's Climate Change Readiness Updates Oncommitments And A", 'pinecone_score': 0.274087071, 'rerank_score': 0.9984452, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.270209789, 'rerank_score': 0.9980276, 'has_values': True}]
2025-08-16 17:38:16,977 - src.models.retrieval - INFO - q='What is climate change?', base=9, kept_pre=9, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.95, delta=0.100, max_sim_pre=0.280, p50_sim_pre=0.270, p95_sim_pre=0.280, blocked_base=0, dropped_top2=[]
2025-08-16 17:38:16,978 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:38:16,978 - src.models.climate_pipeline - INFO - Timing: retrieval=1054.5ms
2025-08-16 17:38:16,978 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:38:16,978 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:38:16,978 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:16,981 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:16,981 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:16,983 - src.models.gen_response_unified - INFO - Cache hit for nova - returning cached response
2025-08-16 17:38:16,983 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:38:16,983 - src.models.climate_pipeline - INFO - Timing: generation=5.1ms
2025-08-16 17:38:16,983 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:38:18,808 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1824 status=OK request_id=99bd0ddc-2db3-4cd4-ba4a-72107ada8d72
2025-08-16 17:38:18,809 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:38:18,809 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:38:18,809 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:38:18,809 - src.models.climate_pipeline - INFO - Timing: faithfulness=1826.5ms
2025-08-16 17:38:18,809 - src.models.climate_pipeline - INFO - Step 8: Translating response to hungarian (code=hu)
2025-08-16 17:38:31,073 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=12263 status=OK request_id=675f8c78-51f9-46e6-bc48-2e1d7f9aef7b
2025-08-16 17:38:31,075 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to hungarian
2025-08-16 17:38:31,075 - src.models.climate_pipeline - INFO - Timing: translation=12265.2ms
2025-08-16 17:38:31,075 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:31,081 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:31,081 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:31,083 - src.models.climate_pipeline - INFO - ✓ Response cached in hungarian
2025-08-16 17:38:31,089 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:38:31,090 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.2 rewrite=646.8 guards=0.0 retrieval=1054.5 generation=5.1 faithfulness=1826.5 translation=12265.2 total=16035.3
2025-08-16 17:38:31,090 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 16.04s
2025-08-16 17:38:31,091 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380295037 time=16.052s model=nova faithfulness=0.950
2025-08-16 17:38:31,092 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=16.055s id=req_1755380295037 ip=127.0.0.1
INFO:     127.0.0.1:56660 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:38:32,307 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380312306 query_len=18 lang=sk
2025-08-16 17:38:32,308 - src.webui.api.routers.chat - INFO - Language routing: detected=sk model=nova
2025-08-16 17:38:32,308 - src.models.climate_pipeline - INFO - Processing query: 'Čo je zmena klímy?...' in slovak (code: sk)
2025-08-16 17:38:32,308 - src.models.climate_pipeline - INFO - Raw query repr: 'Čo je zmena klímy?'
2025-08-16 17:38:32,308 - src.models.climate_pipeline - INFO - Router IN → language_name=slovak, language_code=sk
2025-08-16 17:38:32,308 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:38:32,308 - src.models.query_routing - INFO - Language: slovak (sk) → Model: Nova
2025-08-16 17:38:32,308 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:38:32,308 - src.models.climate_pipeline - INFO - Router OUT → english_query='Čo je zmena klímy?'
2025-08-16 17:38:32,308 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Čo je zmena klímy?'
2025-08-16 17:38:32,308 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:38:32,308 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:38:32,309 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:38:32,309 - src.models.query_routing - INFO - Language: slovak (sk) → Model: Nova
2025-08-16 17:38:32,309 - src.models.query_routing - INFO - Translating query from slovak to English
2025-08-16 17:38:32,309 - src.models.query_routing - INFO - Router NET IN → query repr='Čo je zmena klímy?'
2025-08-16 17:38:32,512 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=203 status=OK request_id=ce69db62-6bc4-4f1c-8dd6-067542d08bc8
2025-08-16 17:38:32,512 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:38:32,512 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What is climate change?'
2025-08-16 17:38:32,512 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What is climate change?'
2025-08-16 17:38:32,512 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What is climate change?'
2025-08-16 17:38:32,512 - src.models.climate_pipeline - INFO - Net debug → original_query len=18, utf8_bytes=20
2025-08-16 17:38:32,512 - src.models.climate_pipeline - INFO - Net debug → english_query len=23, utf8_bytes=23
2025-08-16 17:38:32,512 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:38:32,512 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:32,514 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:32,514 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:32,514 - src.models.climate_pipeline - INFO - Cache miss for slovak query
2025-08-16 17:38:32,515 - src.models.climate_pipeline - INFO - Timing: cache=2.2ms
2025-08-16 17:38:32,515 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:38:32,515 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:38:32,515 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=sk, history_len=0
2025-08-16 17:38:32,515 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='Čo je zmena klímy?'
2025-08-16 17:38:32,515 - query_rewriter - INFO - Rewriter NET IN → expected_lang=sk, user_query repr='Čo je zmena klímy?', norm='Čo je zmena klímy?'
2025-08-16 17:38:33,217 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=701 status=OK request_id=bb66cc2f-b948-4384-9769-1282b802267e
2025-08-16 17:38:33,217 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Slovak and asks about climate change.","language":"sk","expected_language":"sk","language_match":true,"classification":"on-topic","rewrite_en":"What is climate change?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:38:33,217 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:38:33,217 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='Čo je zmena klímy?...' expected_lang=sk detected_lang=sk classification=on-topic language_match=True reason='User query is in Slovak and asks about climate change....'
2025-08-16 17:38:33,218 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='sk', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:38:33,218 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What is climate change?'
2025-08-16 17:38:33,218 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:38:33,218 - src.models.climate_pipeline - INFO - Timing: rewrite=703.3ms
2025-08-16 17:38:33,218 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:38:33,218 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:38:33,218 - src.models.climate_pipeline - INFO - Timing: guards=0.0ms
2025-08-16 17:38:33,218 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:38:33,218 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:38:33,218 - src.models.retrieval - INFO - Query embedding IN: query_len=23 chars, query_repr='What is climate change?...'
2025-08-16 17:38:33,818 - src.models.retrieval - INFO - dep=query_embed op=encode ms=600 dense_dim=1024 sparse_tokens=5
2025-08-16 17:38:33,868 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=49 status=OK
2025-08-16 17:38:33,868 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=49 total_ms=49
2025-08-16 17:38:33,999 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=130 status=OK
2025-08-16 17:38:33,999 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:38:33,999 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=130 total_ms=130
2025-08-16 17:38:34,002 - src.models.retrieval - INFO - dep=mmr_embed used_index=9 used_cache=0 embedded=0 ms=0 n_docs=9 valid_vecs=9 q_embed_ms=0
2025-08-16 17:38:34,003 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=11944 n_docs=9
2025-08-16 17:38:34,144 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:38:34,149 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=146.5 status=OK
2025-08-16 17:38:34,150 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.280184954, 'rerank_score': 0.9995272, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.26793474, 'rerank_score': 0.9994536, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.271402389, 'rerank_score': 0.9993857, 'has_values': True}, {'title': "Report For Action Toronto's Climate Change Readiness Updates Oncommitments And A", 'pinecone_score': 0.274087071, 'rerank_score': 0.9984452, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.270209789, 'rerank_score': 0.9980276, 'has_values': True}]
2025-08-16 17:38:34,150 - src.models.retrieval - INFO - q='What is climate change?', base=9, kept_pre=9, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.95, delta=0.100, max_sim_pre=0.280, p50_sim_pre=0.270, p95_sim_pre=0.280, blocked_base=0, dropped_top2=[]
2025-08-16 17:38:34,150 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:38:34,150 - src.models.climate_pipeline - INFO - Timing: retrieval=932.1ms
2025-08-16 17:38:34,150 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:38:34,150 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:38:34,150 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:34,153 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:34,153 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:34,153 - src.models.gen_response_unified - INFO - Cache hit for nova - returning cached response
2025-08-16 17:38:34,153 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:38:34,153 - src.models.climate_pipeline - INFO - Timing: generation=3.2ms
2025-08-16 17:38:34,153 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:38:35,983 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1828 status=OK request_id=dc428604-61ea-437f-a463-b6f2cfb1158e
2025-08-16 17:38:35,983 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:38:35,983 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:38:35,983 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:38:35,983 - src.models.climate_pipeline - INFO - Timing: faithfulness=1829.7ms
2025-08-16 17:38:35,983 - src.models.climate_pipeline - INFO - Step 8: Translating response to slovak (code=sk)
2025-08-16 17:38:46,137 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=10153 status=OK request_id=c901f419-a944-4ef8-a6fe-4365c8d15dde
2025-08-16 17:38:46,139 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to slovak
2025-08-16 17:38:46,139 - src.models.climate_pipeline - INFO - Timing: translation=10155.7ms
2025-08-16 17:38:46,139 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:46,141 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:46,141 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:46,146 - src.models.climate_pipeline - INFO - ✓ Response cached in slovak
2025-08-16 17:38:46,147 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:38:46,148 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.2 rewrite=703.3 guards=0.0 retrieval=932.1 generation=3.2 faithfulness=1829.7 translation=10155.7 total=13830.8
2025-08-16 17:38:46,148 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 13.83s
2025-08-16 17:38:46,148 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380312306 time=13.841s model=nova faithfulness=0.950
2025-08-16 17:38:46,149 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=13.844s id=req_1755380312306 ip=127.0.0.1
INFO:     127.0.0.1:56813 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:38:47,364 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380327362 query_len=26 lang=sl
2025-08-16 17:38:47,364 - src.webui.api.routers.chat - INFO - Language routing: detected=sl model=nova
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - Processing query: 'Kaj je podnebna sprememba?...' in slovenian (code: sl)
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - Raw query repr: 'Kaj je podnebna sprememba?'
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - Router IN → language_name=slovenian, language_code=sl
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:38:47,365 - src.models.query_routing - INFO - Language: slovenian (sl) → Model: Nova
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - Router OUT → english_query='Kaj je podnebna sprememba?'
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Kaj je podnebna sprememba?'
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - Timing: routing=0.3ms
2025-08-16 17:38:47,365 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:38:47,365 - src.models.query_routing - INFO - Language: slovenian (sl) → Model: Nova
2025-08-16 17:38:47,365 - src.models.query_routing - INFO - Translating query from slovenian to English
2025-08-16 17:38:47,365 - src.models.query_routing - INFO - Router NET IN → query repr='Kaj je podnebna sprememba?'
2025-08-16 17:38:48,179 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=813 status=OK request_id=5936ae68-4bba-41c9-986b-1cbecb9f85b6
2025-08-16 17:38:48,211 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:38:48,211 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What is climate change?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. While climate change poses natural fluctuations, the term is often used to '
2025-08-16 17:38:48,231 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate change poses natural fluctuations, the term is often used to '
2025-08-16 17:38:48,231 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. While climate change poses natural fluctuations, the term is often used to '
2025-08-16 17:38:48,231 - src.models.climate_pipeline - INFO - Net debug → original_query len=26, utf8_bytes=26
2025-08-16 17:38:48,231 - src.models.climate_pipeline - INFO - Net debug → english_query len=588, utf8_bytes=588
2025-08-16 17:38:48,231 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:38:48,231 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:48,273 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:48,273 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:48,329 - src.models.climate_pipeline - INFO - Cache miss for slovenian query
2025-08-16 17:38:48,353 - src.models.climate_pipeline - INFO - Timing: cache=121.7ms
2025-08-16 17:38:48,353 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:38:48,353 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:38:48,353 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=sl, history_len=0
2025-08-16 17:38:48,353 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='Kaj je podnebna sprememba?'
2025-08-16 17:38:48,353 - query_rewriter - INFO - Rewriter NET IN → expected_lang=sl, user_query repr='Kaj je podnebna sprememba?', norm='Kaj je podnebna sprememba?'
2025-08-16 17:38:48,990 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=636 status=OK request_id=89f935c1-8fc4-4942-bd05-f8107f79ebd8
2025-08-16 17:38:48,991 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Slovenian and asks about climate change.","language":"sl","expected_language":"sl","language_match":true,"classification":"on-topic","rewrite_en":"What is climate change?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:38:48,991 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:38:48,991 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='Kaj je podnebna sprememba?...' expected_lang=sl detected_lang=sl classification=on-topic language_match=True reason='User query is in Slovenian and asks about climate change....'
2025-08-16 17:38:48,991 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='sl', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:38:48,991 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What is climate change?'
2025-08-16 17:38:48,991 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:38:48,991 - src.models.climate_pipeline - INFO - Timing: rewrite=638.5ms
2025-08-16 17:38:48,991 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:38:48,991 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:38:48,991 - src.models.climate_pipeline - INFO - Timing: guards=0.0ms
2025-08-16 17:38:48,992 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:38:48,992 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:38:48,992 - src.models.retrieval - INFO - Query embedding IN: query_len=23 chars, query_repr='What is climate change?...'
2025-08-16 17:38:50,548 - src.models.retrieval - INFO - dep=query_embed op=encode ms=1556 dense_dim=1024 sparse_tokens=5
2025-08-16 17:38:50,607 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=51 status=OK
2025-08-16 17:38:50,607 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=52 total_ms=52
2025-08-16 17:38:50,782 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=174 status=OK
2025-08-16 17:38:50,782 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:38:50,782 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=174 total_ms=174
2025-08-16 17:38:50,785 - src.models.retrieval - INFO - dep=mmr_embed used_index=9 used_cache=0 embedded=0 ms=0 n_docs=9 valid_vecs=9 q_embed_ms=0
2025-08-16 17:38:50,787 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=11944 n_docs=9
2025-08-16 17:38:51,000 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:38:51,021 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=233.6 status=OK
2025-08-16 17:38:51,035 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.280184954, 'rerank_score': 0.9995272, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.26793474, 'rerank_score': 0.9994536, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.271402389, 'rerank_score': 0.9993857, 'has_values': True}, {'title': "Report For Action Toronto's Climate Change Readiness Updates Oncommitments And A", 'pinecone_score': 0.274087071, 'rerank_score': 0.9984452, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.270209789, 'rerank_score': 0.9980276, 'has_values': True}]
2025-08-16 17:38:51,036 - src.models.retrieval - INFO - q='What is climate change?', base=9, kept_pre=9, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.95, delta=0.100, max_sim_pre=0.280, p50_sim_pre=0.270, p95_sim_pre=0.280, blocked_base=0, dropped_top2=[]
2025-08-16 17:38:51,039 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:38:51,039 - src.models.climate_pipeline - INFO - Timing: retrieval=2047.1ms
2025-08-16 17:38:51,039 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:38:51,039 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:38:51,039 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:38:51,044 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:38:51,044 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:38:51,044 - src.models.gen_response_unified - INFO - Cache hit for nova - returning cached response
2025-08-16 17:38:51,045 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:38:51,045 - src.models.climate_pipeline - INFO - Timing: generation=6.1ms
2025-08-16 17:38:51,045 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:38:52,938 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1892 status=OK request_id=e0857b01-7c7f-4efb-8a65-d4588ef9094e
2025-08-16 17:38:52,940 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:38:52,941 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:38:52,941 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:38:52,941 - src.models.climate_pipeline - INFO - Timing: faithfulness=1896.0ms
2025-08-16 17:38:52,941 - src.models.climate_pipeline - INFO - Step 8: Translating response to slovenian (code=sl)
2025-08-16 17:39:02,723 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=9781 status=OK request_id=789ab49b-a338-475c-bcba-ff8b18210b43
2025-08-16 17:39:02,727 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to slovenian
2025-08-16 17:39:02,728 - src.models.climate_pipeline - INFO - Timing: translation=9786.7ms
2025-08-16 17:39:02,729 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:39:02,735 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:39:02,735 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:39:02,737 - src.models.climate_pipeline - INFO - ✓ Response cached in slovenian
2025-08-16 17:39:02,738 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:39:02,739 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.3 rewrite=638.5 guards=0.0 retrieval=2047.1 generation=6.1 faithfulness=1896.0 translation=9786.7 total=15363.3
2025-08-16 17:39:02,739 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 15.36s
2025-08-16 17:39:02,740 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380327362 time=15.376s model=nova faithfulness=0.950
2025-08-16 17:39:02,741 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=15.378s id=req_1755380327362 ip=127.0.0.1
INFO:     127.0.0.1:56943 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:39:03,958 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380343956 query_len=31 lang=bg
2025-08-16 17:39:03,958 - src.webui.api.routers.chat - INFO - Language routing: detected=bg model=nova
2025-08-16 17:39:03,958 - src.models.climate_pipeline - INFO - Processing query: 'Какво е изменението на климата?...' in bulgarian (code: bg)
2025-08-16 17:39:03,959 - src.models.climate_pipeline - INFO - Raw query repr: 'Какво е изменението на климата?'
2025-08-16 17:39:03,959 - src.models.climate_pipeline - INFO - Router IN → language_name=bulgarian, language_code=bg
2025-08-16 17:39:03,959 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:39:03,959 - src.models.query_routing - INFO - Language: bulgarian (bg) → Model: Nova
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Router OUT → english_query='Какво е изменението на климата?'
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Какво е изменението на климата?'
2025-08-16 17:39:03,960 - src.models.climate_pipeline - WARNING - Router language mismatch: query is in Russian but Bulgarian was selected
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Proceeding despite router mismatch (soft warning only)
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Timing: routing=1.1ms
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:39:03,960 - src.models.query_routing - INFO - Language: bulgarian (bg) → Model: Nova
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='Какво е изменението на климата?'
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='Какво е изменението на климата?'
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Net debug → original_query len=31, utf8_bytes=57
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Net debug → english_query len=31, utf8_bytes=57
2025-08-16 17:39:03,960 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:39:03,960 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:39:03,965 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:39:03,965 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:39:03,966 - src.models.climate_pipeline - INFO - Cache miss for bulgarian query
2025-08-16 17:39:03,972 - src.models.climate_pipeline - INFO - Timing: cache=12.5ms
2025-08-16 17:39:03,972 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:39:03,972 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:39:03,973 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=bg, history_len=0
2025-08-16 17:39:03,973 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='Какво е изменението на климата?'
2025-08-16 17:39:03,973 - query_rewriter - INFO - Rewriter NET IN → expected_lang=bg, user_query repr='Какво е изменението на климата?', norm='Какво е изменението на климата?'
2025-08-16 17:39:04,583 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=610 status=OK request_id=5142cf38-47f1-420b-8963-ed0af3e89fc1
2025-08-16 17:39:04,583 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Bulgarian and asks about climate change.","language":"bg","expected_language":"bg","language_match":true,"classification":"on-topic","rewrite_en":"What is climate change?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:39:04,584 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:39:04,584 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='Какво е изменението на климата?...' expected_lang=bg detected_lang=bg classification=on-topic language_match=True reason='User query is in Bulgarian and asks about climate change....'
2025-08-16 17:39:04,584 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='bg', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:39:04,584 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What is climate change?'
2025-08-16 17:39:04,584 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:39:04,584 - src.models.climate_pipeline - INFO - Timing: rewrite=611.5ms
2025-08-16 17:39:04,584 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:39:04,584 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:39:04,584 - src.models.climate_pipeline - INFO - Timing: guards=0.0ms
2025-08-16 17:39:04,584 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:39:04,584 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:39:04,584 - src.models.retrieval - INFO - Query embedding IN: query_len=23 chars, query_repr='What is climate change?...'
2025-08-16 17:39:05,258 - src.models.retrieval - INFO - dep=query_embed op=encode ms=673 dense_dim=1024 sparse_tokens=5
2025-08-16 17:39:05,302 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=43 status=OK
2025-08-16 17:39:05,302 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=43 total_ms=43
2025-08-16 17:39:05,428 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=125 status=OK
2025-08-16 17:39:05,428 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:39:05,428 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=125 total_ms=125
2025-08-16 17:39:05,430 - src.models.retrieval - INFO - dep=mmr_embed used_index=9 used_cache=0 embedded=0 ms=0 n_docs=9 valid_vecs=9 q_embed_ms=0
2025-08-16 17:39:05,431 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=11944 n_docs=9
2025-08-16 17:39:05,570 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:39:05,573 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=141.7 status=OK
2025-08-16 17:39:05,574 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.280184954, 'rerank_score': 0.9995272, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.26793474, 'rerank_score': 0.9994536, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.271402389, 'rerank_score': 0.9993857, 'has_values': True}, {'title': "Report For Action Toronto's Climate Change Readiness Updates Oncommitments And A", 'pinecone_score': 0.274087071, 'rerank_score': 0.9984452, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.270209789, 'rerank_score': 0.9980276, 'has_values': True}]
2025-08-16 17:39:05,574 - src.models.retrieval - INFO - q='What is climate change?', base=9, kept_pre=9, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.95, delta=0.100, max_sim_pre=0.280, p50_sim_pre=0.270, p95_sim_pre=0.280, blocked_base=0, dropped_top2=[]
2025-08-16 17:39:05,574 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:39:05,574 - src.models.climate_pipeline - INFO - Timing: retrieval=990.2ms
2025-08-16 17:39:05,574 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:39:05,575 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:39:05,575 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:39:05,576 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:39:05,576 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:39:05,577 - src.models.gen_response_unified - INFO - Cache hit for nova - returning cached response
2025-08-16 17:39:05,577 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:39:05,577 - src.models.climate_pipeline - INFO - Timing: generation=2.4ms
2025-08-16 17:39:05,577 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:39:07,439 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=1861 status=OK request_id=714fcc03-d6a0-4566-a62a-d504fbefde12
2025-08-16 17:39:07,440 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:39:07,440 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:39:07,440 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:39:07,440 - src.models.climate_pipeline - INFO - Timing: faithfulness=1863.1ms
2025-08-16 17:39:07,440 - src.models.climate_pipeline - INFO - Step 8: Translating response to bulgarian (code=bg)
2025-08-16 17:39:16,707 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=9266 status=OK request_id=4865019d-600f-44d7-bacc-66799b056c91
2025-08-16 17:39:16,710 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to bulgarian
2025-08-16 17:39:16,710 - src.models.climate_pipeline - INFO - Timing: translation=9270.0ms
2025-08-16 17:39:16,711 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:39:16,714 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:39:16,714 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:39:16,715 - src.models.climate_pipeline - INFO - ✓ Response cached in bulgarian
2025-08-16 17:39:16,716 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:39:16,719 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=1.1 rewrite=611.5 guards=0.0 retrieval=990.2 generation=2.4 faithfulness=1863.1 translation=9270.0 total=12751.8
2025-08-16 17:39:16,719 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 12.75s
2025-08-16 17:39:16,720 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380343956 time=12.763s model=nova faithfulness=0.950
2025-08-16 17:39:16,721 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=12.765s id=req_1755380343956 ip=127.0.0.1
INFO:     127.0.0.1:57096 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
2025-08-16 17:39:17,940 - src.webui.api.routers.chat - INFO - Processing chat query: id=req_1755380357938 query_len=22 lang=hr
2025-08-16 17:39:17,940 - src.webui.api.routers.chat - INFO - Language routing: detected=hr model=nova
2025-08-16 17:39:17,940 - src.models.climate_pipeline - INFO - Processing query: 'Što je promjena klime?...' in croatian (code: hr)
2025-08-16 17:39:17,940 - src.models.climate_pipeline - INFO - Raw query repr: 'Što je promjena klime?'
2025-08-16 17:39:17,941 - src.models.climate_pipeline - INFO - Router IN → language_name=croatian, language_code=hr
2025-08-16 17:39:17,941 - src.models.climate_pipeline - INFO - Step 1: Query Routing
2025-08-16 17:39:17,941 - src.models.query_routing - INFO - Language: croatian (hr) → Model: Nova
2025-08-16 17:39:17,941 - src.models.climate_pipeline - INFO - Router OUT → model=Nova, support=nova, needs_translation=True
2025-08-16 17:39:17,941 - src.models.climate_pipeline - INFO - Router OUT → english_query='Što je promjena klime?'
2025-08-16 17:39:17,941 - src.models.climate_pipeline - INFO - Router OUT → processed_query='Što je promjena klime?'
2025-08-16 17:39:17,941 - src.models.climate_pipeline - INFO - ✓ Routed to Nova model
2025-08-16 17:39:17,941 - src.models.climate_pipeline - INFO - Timing: routing=0.2ms
2025-08-16 17:39:17,941 - src.models.climate_pipeline - INFO - Routing requires translation → provider=Nova
2025-08-16 17:39:17,941 - src.models.query_routing - INFO - Language: croatian (hr) → Model: Nova
2025-08-16 17:39:17,941 - src.models.query_routing - INFO - Translating query from croatian to English
2025-08-16 17:39:17,941 - src.models.query_routing - INFO - Router NET IN → query repr='Što je promjena klime?'
2025-08-16 17:39:18,674 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=733 status=OK request_id=44219ff1-c57d-4b28-b46c-edba9d87df72
2025-08-16 17:39:18,744 - src.models.query_routing - INFO - Translation successful
2025-08-16 17:39:18,745 - src.models.query_routing - INFO - Router NET OUT → english_query repr='What is climate change?\n\nClimate change refers to significant changes in global temperatures and weather patterns over time. These changes can occur naturally, but the term is most often used to descr'
2025-08-16 17:39:18,746 - src.models.climate_pipeline - INFO - Router RERUN OUT → english_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. These changes can occur naturally, but the term is most often used to descr'
2025-08-16 17:39:18,746 - src.models.climate_pipeline - INFO - Router RERUN OUT → processed_query='What is climate change?

Climate change refers to significant changes in global temperatures and weather patterns over time. These changes can occur naturally, but the term is most often used to descr'
2025-08-16 17:39:18,746 - src.models.climate_pipeline - INFO - Net debug → original_query len=22, utf8_bytes=23
2025-08-16 17:39:18,746 - src.models.climate_pipeline - INFO - Net debug → english_query len=590, utf8_bytes=590
2025-08-16 17:39:18,746 - src.models.climate_pipeline - INFO - Step 2: Cache Check
2025-08-16 17:39:18,746 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:39:18,773 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:39:18,773 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:39:18,774 - src.models.climate_pipeline - INFO - Cache miss for croatian query
2025-08-16 17:39:18,776 - src.models.climate_pipeline - INFO - Timing: cache=30.3ms
2025-08-16 17:39:18,776 - src.models.climate_pipeline - INFO - Step 3: Query Rewriting
2025-08-16 17:39:18,776 - src.models.conversation_parser - INFO - No conversation history to format
2025-08-16 17:39:18,776 - src.models.climate_pipeline - INFO - Rewriter IN → expected_lang=hr, history_len=0
2025-08-16 17:39:18,776 - src.models.climate_pipeline - INFO - Rewriter IN → original_query='Što je promjena klime?'
2025-08-16 17:39:18,776 - query_rewriter - INFO - Rewriter NET IN → expected_lang=hr, user_query repr='Što je promjena klime?', norm='Što je promjena klime?'
2025-08-16 17:39:19,439 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=662 status=OK request_id=f1aa8678-19d6-4170-a48d-c4885ef031ac
2025-08-16 17:39:19,441 - query_rewriter - INFO - Model raw (first 300): {"reason":"User query is in Croatian and asks about climate change.","language":"hr","expected_language":"hr","language_match":true,"classification":"on-topic","rewrite_en":"What is climate change?","ask_how_to_use":false,"how_it_works":null,"error":null}
2025-08-16 17:39:19,441 - query_rewriter - INFO - Rewriter NET OUT → json keys=['ask_how_to_use', 'classification', 'error', 'expected_language', 'how_it_works', 'language', 'language_match', 'reason', 'rewrite_en']
2025-08-16 17:39:19,442 - query_rewriter - INFO - 🔍 CLASSIFICATION_DEBUG: query='Što je promjena klime?...' expected_lang=hr detected_lang=hr classification=on-topic language_match=True reason='User query is in Croatian and asks about climate change....'
2025-08-16 17:39:19,444 - src.models.climate_pipeline - INFO - Rewriter OUT → detected_lang='hr', classification='on-topic', language_match='yes', canned=False
2025-08-16 17:39:19,444 - src.models.climate_pipeline - INFO - Rewriter OUT → rewrite_en='What is climate change?'
2025-08-16 17:39:19,444 - src.models.climate_pipeline - INFO - ✓ Query rewritten (JSON) for better retrieval
2025-08-16 17:39:19,444 - src.models.climate_pipeline - INFO - Timing: rewrite=667.6ms
2025-08-16 17:39:19,444 - src.models.climate_pipeline - INFO - Step 4: Input Guards
2025-08-16 17:39:19,444 - src.models.climate_pipeline - INFO - ✓ Input guards passed
2025-08-16 17:39:19,444 - src.models.climate_pipeline - INFO - Timing: guards=0.0ms
2025-08-16 17:39:19,444 - src.models.climate_pipeline - INFO - Step 5: Document Retrieval
2025-08-16 17:39:19,444 - src.models.retrieval - INFO - 🔄 Pre-computing query embeddings to avoid redundant encode() calls
2025-08-16 17:39:19,444 - src.models.retrieval - INFO - Query embedding IN: query_len=23 chars, query_repr='What is climate change?...'
2025-08-16 17:39:20,509 - src.models.retrieval - INFO - dep=query_embed op=encode ms=1064 dense_dim=1024 sparse_tokens=5
2025-08-16 17:39:20,562 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=45 status=OK
2025-08-16 17:39:20,562 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=46 total_ms=46
2025-08-16 17:39:20,698 - src.models.retrieval - INFO - dep=pinecone host=unknown op=query ms=135 status=OK
2025-08-16 17:39:20,699 - src.models.retrieval - INFO - pinecone.match type=<class 'pinecone.core.openapi.data.model.scored_vector.ScoredVector'> attrs_have_values=True has_values=True
2025-08-16 17:39:20,699 - src.models.retrieval - INFO - dep=hybrid_search embed_ms=0 query_ms=136 total_ms=136
2025-08-16 17:39:20,703 - src.models.retrieval - INFO - dep=mmr_embed used_index=9 used_cache=0 embedded=0 ms=0 n_docs=9 valid_vecs=9 q_embed_ms=0
2025-08-16 17:39:20,704 - src.models.rerank - INFO - dep=cohere_rerank payload_chars=11944 n_docs=9
2025-08-16 17:39:20,863 - httpx - INFO - HTTP Request: POST https://api.cohere.com/v1/rerank "HTTP/1.1 200 OK"
2025-08-16 17:39:20,872 - src.models.rerank - INFO - dep=cohere_rerank host=api.cohere.com op=rerank ms=167.5 status=OK
2025-08-16 17:39:20,874 - src.models.retrieval - INFO - Retained docs preview: [{'title': 'Health Of Canadians In Changing Climate Report', 'pinecone_score': 0.280184954, 'rerank_score': 0.9995272, 'has_values': True}, {'title': 'Canadian Communities’ Guidebook For Adaptation To Climate Change Including An Ap', 'pinecone_score': 0.26793474, 'rerank_score': 0.9994536, 'has_values': True}, {'title': 'Planning To Be A Part Of My Region! Grade 9 Lesson Plans Designed For Students I', 'pinecone_score': 0.271402389, 'rerank_score': 0.9993857, 'has_values': True}, {'title': "Report For Action Toronto's Climate Change Readiness Updates Oncommitments And A", 'pinecone_score': 0.274087071, 'rerank_score': 0.9984452, 'has_values': True}, {'title': '11356 2022 Article 19718', 'pinecone_score': 0.270209789, 'rerank_score': 0.9980276, 'has_values': True}]
2025-08-16 17:39:20,874 - src.models.retrieval - INFO - q='What is climate change?', base=9, kept_pre=9, refill=0, final_before=5, final_after=5, hybrid_refill=0, floor=0.95, delta=0.100, max_sim_pre=0.280, p50_sim_pre=0.270, p95_sim_pre=0.280, blocked_base=0, dropped_top2=[]
2025-08-16 17:39:20,874 - src.models.climate_pipeline - INFO - ✓ Retrieved 5 documents
2025-08-16 17:39:20,874 - src.models.climate_pipeline - INFO - Timing: retrieval=1430.2ms
2025-08-16 17:39:20,874 - src.models.climate_pipeline - INFO - Step 6: Response Generation (Nova)
2025-08-16 17:39:20,874 - src.models.gen_response_unified - INFO - Starting nova response generation
2025-08-16 17:39:20,875 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:39:20,881 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:39:20,881 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:39:20,882 - src.models.gen_response_unified - INFO - Cache hit for nova - returning cached response
2025-08-16 17:39:20,883 - src.models.climate_pipeline - INFO - ✓ Response generated successfully in English
2025-08-16 17:39:20,883 - src.models.climate_pipeline - INFO - Timing: generation=8.5ms
2025-08-16 17:39:20,883 - src.models.climate_pipeline - INFO - Step 7: Quality Validation
2025-08-16 17:39:23,601 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=2717 status=OK request_id=079711fa-6525-4e3b-8d68-73b90d85dd2c
2025-08-16 17:39:23,602 - src.models.hallucination_guard - INFO - Faithfulness score: 0.95
2025-08-16 17:39:23,602 - src.models.climate_pipeline - INFO - ✓ Faithfulness score: 0.950
2025-08-16 17:39:23,602 - src.models.climate_pipeline - INFO - ✓ Assessment: Highly Faithful
2025-08-16 17:39:23,602 - src.models.climate_pipeline - INFO - Timing: faithfulness=2719.5ms
2025-08-16 17:39:23,602 - src.models.climate_pipeline - INFO - Step 8: Translating response to croatian (code=hr)
2025-08-16 17:39:33,497 - src.models.nova_flow - INFO - dep=bedrock host=bedrock.us-east-1.amazonaws.com op=invoke_model ms=9893 status=OK request_id=4bbcacdb-dc39-449a-880f-b9b7e8f15b2f
2025-08-16 17:39:33,500 - src.models.climate_pipeline - INFO - ✓ Response translated successfully to croatian
2025-08-16 17:39:33,500 - src.models.climate_pipeline - INFO - Timing: translation=9897.9ms
2025-08-16 17:39:33,501 - src.models.redis_cache - INFO - Initializing Redis connection to localhost:6379 (SSL: False)
2025-08-16 17:39:33,514 - src.models.redis_cache - INFO - ✓ Redis connection test successful to localhost
2025-08-16 17:39:33,514 - src.models.redis_cache - INFO - ✓ Redis cache initialized for localhost
2025-08-16 17:39:33,516 - src.models.climate_pipeline - INFO - ✓ Response cached in croatian
2025-08-16 17:39:33,518 - src.models.climate_pipeline - INFO - ✓ English version also cached
2025-08-16 17:39:33,520 - src.models.climate_pipeline - INFO - Timing summary (ms): routing=0.2 rewrite=667.6 guards=0.0 retrieval=1430.2 generation=8.5 faithfulness=2719.5 translation=9897.9 total=15559.9
2025-08-16 17:39:33,520 - src.models.climate_pipeline - INFO - ✓ Query processed successfully in 15.56s
2025-08-16 17:39:33,522 - src.webui.api.routers.chat - INFO - Query processed successfully: id=req_1755380357938 time=15.582s model=nova faithfulness=0.950
2025-08-16 17:39:33,524 - src.webui.api.main - INFO - REQUEST POST /api/v1/chat/query status=200 time=15.585s id=req_1755380357938 ip=127.0.0.1
INFO:     127.0.0.1:57231 - "POST /api/v1/chat/query HTTP/1.1" 200 OK
